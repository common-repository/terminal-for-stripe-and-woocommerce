=== Terminal for Stripe and WooCommerce ===
Contributors: arcanedevops
Donate link: https://www.arcanestrategies.com/
Plugin Name: Terminal for Stripe and WooCommerce
Plugin URI: https://www.arcanestrategies.com/products/#product-stripe-terminal-for-woocommerce
Author URI: https://www.arcanestrategies.com/
Author: Arcane Strategies
Tags: stripe, woocommerce, stripe terminal, verifone, point of sale, in person payments, pos, p400, bbpos, chipper 2x bt, wise pos e, card reader, ecommerce, e-commerce, store, sales, sell, shop, stripe m2, checkout, payments, storefront, woo, wcpos
Version: 2.2.4
Requires at least: 5.5.0
Tested up to: 6.2.0
Requires PHP: 7.3
Requires WooCommerce: 5.1.0
WooCommerce tested up to: 7.6.0
Requires WooCommerce Stripe Gateway: 5.3.0
WooCommerce Stripe Gateway tested up to: 7.3.0
Stable: 2.2.4
License: GPLv3
License URI: https://www.gnu.org/licenses/gpl-3.0.html

Terminal for Stripe and WooCommerce connects in-person transactions to your website. Built on WordPress, WooCommerce, and WooCommerce Stripe Gateway, it permits a BBPOS Wise POS E, Stripe M2, BBPOS Chipper 2x bt, or Verifone P400 POS to integrate directly to your website.  This version builds on its sibling, Terminal for Stripe and WooCommerce, by adding support for location and user management, customer data storage, and support for customer-account driven product types like subscriptions, digital downloads, and virtual products.

This free plugin is for guest checkout-only.  Support for customer information is provided in our PRO services package.

== Description ==

Terminal for Stripe and WooCommerce connects in-person transactions to your website. Built on WordPress, WooCommerce, and WooCommerce Stripe Gateway, it permits a BBPOS Wise POS E, Stripe M2, BBPOS Chipper 2x bt, or Verifone P400 POS to integrate directly to your website for all types of products and offers the benefit to sync data between WooCommerce and Stripe.

To activate the Free Terminal for Stripe and WooCommerce plugin on an existing WooCommerce in minutes visit our website for full step-by-step instructions, with video, for installation and setup of your plugin and Verifone P400, BBPOS Wise POS E, Stripe M2, or BBPOS Chipper devices: [Stripe Terminal for WooCommerce Instructions]{https://www.arcanestrategies.com/portfolio/stripe-terminal-for-woocommerce/)

Terminal for Stripe and WooCommerce is developed and supported by Arcane Strategies, the creators of Witmap.io and Skipwish.com.

[Installation and Setup](https://www.youtube.com/watch?v=OMlidhenDBo)
[PRO Services Install](https://www.youtube.com/watch?v=3iQNV_P2kVk)
[ArcanePOS Mobile app for Bluetooth Readers](https://www.youtube.com/watch?v=pih-qSx_fMw)

As is standard practice, payment gateways will charge transaction fees for card payments.  Fees may be found on our website at store.arcanestrategies.com. Please be sure to review our plan features list to be sure you are getting all the features required for your usage: [https://store.arcanestrategies.com/products/stripe-terminal-for-woocommerce](https://store.arcanestrategies.com/products/stripe-terminal-for-woocommerce)

NOTE: V3.0 will include fleet management and customer data storage related features currently available in PRO such as customer account creation, customer billing and shipping storage, and more.  Legacy synchronization tools and reduced fees will remain restricted to PRO

== Features ==

* In-Person Payments Connected to WooCommerce and Stripe
* 1 Location with Multiple Verifone Readers
* BBPOS Wise POS E, BBPOS Chipper 2x bt, Stripe M2, and Verifone P400 POS devices
* Supports Apple Pay, Google Pay, and Samsung Pay
* Pre-Dip Cards
* Supports BBPOS Chipper through Arcane's mobile appliation available for free download on iOS and Android (search "Arcane POS")
* Web UI support for WC POS plugins as of 2022

This plugin is meant to process transactions using the WooCommerce default DOM structure and WP best practices.  If you are using a POS plugin which abandons the intended WP theme structure, it will not work.  If you are looking for a compatible POS interface, check out our [Virtual Terminal Point of Sale for WooCommerce](https://www.arcanestrategies.com/portfolio/stripe-terminal-standalone-pos/) or [WC POS Pro by Kilbot](https://wcpos.com/)

This plugin version contains a limited featureset.  For additional features not supported by this plugin such as legacy data synchronization, customer data storage, and fleet managemetn, PRO services is required.  Please be sure to review our plan features list to be sure you are getting all the features required for your usage: [https://store.arcanestrategies.com/products/stripe-terminal-for-woocommerce](https://store.arcanestrategies.com/products/stripe-terminal-for-woocommerce)

NOTE: V3.0 will include fleet management and customer data storage related features currently available in PRO such as customer account creation, customer billing and shipping storage, and more.  Legacy synchronization tools and reduced fees will remain restricted to PRO

= Additional Features =

For a more robust solution, check out the features of our Pro Version for [Stripe Terminal](https://www.arcanestrategies.com/portfolio/stripe-terminal-for-woocommerce/). To upgrade, click on the following link to purchase our PRO Version for [Stripe Terminal](https://store.arcanestrategies.com/products/stripe-terminal-for-woocommerce)
Support for Pro Version is available at [www.ArcaneStrategies.com](https://www.arcaneStrategies.com). Terminal for Stripe and WooCommerce is developed and supported by [Arcane Strategies](https://www.arcaneStrategies.com), the creators of Witmap.io and [Skipwish.com](https://www.skipwish.com).

Please subscribe to our mailchimp list to receive updates on new features [https://www.arcanestrategies.com/subscribe/](https://www.arcanestrategies.com/subscribe/):

= Minimum Requirements =

* PHP 7.0 or greater is recommended
* MySQL 5.6 or greater is recommended
* In order for the terminal option to be available, you must be logged in as an authorized WordPress administrator or Store Manager (otherwise all your site visitors would see it).
* All orders are associated with cashier, so this will not support account-specific orders (ie. subscriptions)

Visit the [WooCommerce server requirements documentation](https://docs.woocommerce.com/document/server-requirements/?utm_source=wp%20org%20repo%20listing&utm_content=3.6) for a detailed list of server requirements.

= Usage =

* You must be logged in as a WooCommerce store manager (ie. role "Administrator" or "Store Manager") in order to use the Terminal on the frontend.
* While logged in, navigate your customer through the checkout experience. You'll be given the option to select the terminal reader icon to process accordingly.
* After selecting the terminal option, press the button for the reader you set up during installation.
* Credit card prompts will expire after 45 seconds but may be manually canceled by hitting the "Esc" key on your keyboard.
* For alternative checkout options, use the WC Orders panel with the "Customer Payment Page" and/or leverage our "Process with Mobile App" button to open with a Bluetooth reader

== Installation ==

Due to the growing number of devices, instructions are maintained on the official [Arcane POS Stripe Terminal information page](https://www.arcanestrategies.com/portfolio/stripe-terminal-for-woocommerce/)

Instructions: [Stripe Terminal for WooCommerce Instructions](https://www.arcanestrategies.com/blog/free-stripe-terminal-woocommerce-setup/)

== Frequently Asked Questions ==

= Do you support any POS plugins? =
If you are looking for a compatible POS interface, check out our [Virtual Terminal Point of Sale for WooCommerce](https://www.arcanestrategies.com/portfolio/stripe-terminal-standalone-pos/) or [WC POS Pro by Kilbot](https://wcpos.com/)
= Customer Payment Page  throws error "Stripe Terminal is not enabled" but it is enabled. How to fix this? =
This is likely because either your order or your cart contains ineligible order data.  Even if your order data is valid, if your cart contains items which do not support this payment method, it will still fail and you will have to empty your cart first.  That is a WC flaw, it isn't caused by our plugin.
= Why do I get a critical error when creating orders on the mobile app? =
If you have WC Pay (WooCommerce Payments) installed, disable it.  If not, read the next sentence.  The API is built on the V3 legacy API which uses the WC_API_Orders function.  Functions which attempt to hook into the order methods will malfunction.  The add_order_meta() function is one which we've seen does not match the same number of arguments as exists within the v3 legacy API.
= Are there any costs involved? =
This is a free plugin, so there are no license fees but you do have to pay your transaction fees as you would with any gateway plugin.  Transaction fees are split between us and Stripe and will be reflected as such in your Stripe account.  The pro and plus versions do have license fees required which can be found on our website at store.arcanestrategies.com
= I keep getting a generic API error when saving plugins settings =
This could be a number of things but more often than not it is because of the following:
(1) The plugin is not enabled (see "activate" and settings "enable" checkbox), (2) The Stripe Gateway payment method within WooCommerce is disabled OR API keys are incorrect, (3) The Stripe Gateway's "Payment Buttons" option is disabled; in versions of Stripe Gateay 5.8+ this is also referred to as "Express Checkouts".
= What other plugins are required?  =
WooCommerce and WooCommerce Stripe Gateway.  Supported versioning can be found in the README file.
= How do I add a BBPOS Wise POS E or Verifone P400 reader? =
See this link [https://www.arcanestrategies.com/blog/bbpos-wise-pos-e-setup/](https://www.arcanestrategies.com/blog/bbpos-wise-pos-e-setup/)
See this link [https://www.arcanestrategies.com/blog/verifone-p400-setup/](https://www.arcanestrategies.com/blog/verifone-p400-setup/)
= How can I use the BBPOS Chipper or Stripe M2? =
Follow the instructions seen here: [https://www.arcanestrategies.com/blog/bbpos-chipper-reader-setup/](https://www.arcanestrategies.com/blog/bbpos-chipper-reader-setup/)
Within the plugin's settings, (1) enter your Stripe Account ID, (2) within your wordpress permalink settings, make sure you have pretty URLs enabled (post anme), (3) click on the "Stripe Connect" button to complete account connection, (4) download our plugin (see link in Settings) and follow in-app instructions. 
= I can't see the reader on checkout, any idea why? =
The reader will only show on checkout if (a) the device is powered on, (b) the terminal is registered, (c) a user with woocommerce store management permissions is logged in, (d) the cart contains only simple products.  This version is intended only to provide a retail point-of-sale experience in which an authorized representative is logged in to accept credit cards.  This is both for tracking who has accepted charges as well as to prevent the public from seeing the terminal icon while remotely viewing the site.  Because of this, purchases which require customer information (such as recurring billing info or email addresses) cannot be performed as the current session contains the administrator's information.  If you need to work around that, visit our website and purchase "Pro Services".  If you are already a PRO Services user, verify that your user is assigned to a location. (https://www.arcanestrategies.com/products/stripe-terminal-for-woocommerce)
= Will your plugin work outside the US? =
Our plugin will support any location that Stripe supports, there's no business logic implemented which would prevent support for our plugin in a region where Stripe Terminal is available.  As of date of this writing (January 2020), Stripe Terminal is only supported in North America (US and Canada).  Although Stripe does allow transactions overseas for cards typically used in European countries like Maestro, PIN transactions for those unsupported regions are not available.  Additionally, the readers themselves are not available for purchase outside the US.  As soon as Stripe announces support overseas, anyone who installs either of our plugins will receive notification.
= Where can I buy a reader? =
Our support team will only support the readers purchased directly from Stripe.com or [https://store.arcanestrategies.com/](https://store.arcanestrategies.com/).  These readers will not come equipped with the Stripe Terminal software pre-installed unless it's purchased from Stripe.com which means you won't be able to use the device with Stripe out-of-the-box, unless you buy from Stripe or lease from us.
= Why doesn't the cancel button work? =
To cancel an order, hit the "esc" key on your keyboard or wait for the timeout to expire.  The Verifone P400's action buttons (red, yellow, green) are intended to support settings, they do not cancel or edit payments.
= Are PIN transactions supported? =
Unfortunately Stripe Terminal does not support PIN transactions but they do support debit via signature.  We spoke with Stripe and they indicated they have no plan in making PIN transactions possible as they believe that signature debit transactions is sufficient.
= Why am I getting an error connecting to my reader?  I registered it without a problem! =
Whe you register your device, Stripe Terminal will assign your WiFi enabled device to a domain on your private network.  This makes it reachable by the API.  Some Domain Name Servers do not play nicely with that setup, so they may block that traffic.  We suggest that you try switching your network's DNS provider to CloudFlare (1.1.1.1) or Google (8.8.8.8).  Although Stripe states that Google should work, we've had customers indicate that it does not, so try both.
= Why isn't the customer's information shown on the invoice and email receipt? =
Please review the documentation above.  Customer account information is not supported in this version, you must purchase PRO Services.  Out-of-the-box, Stripe Terminal does not gather PII data and WooCommerce will bill to the account which is logged in (the admin performing the checkout).  Our PRO Services add-on allows for customer account support to perform purchases for things like subscriptions.
= The mobile app is applying tax on tips.  How can I fix this? =
This is a known issue within the WooCommerce legacy API, it is not an issue within our plugin.  Our mobile app leverages the legacy WooCommerce API (through our API handler) which passes the correct tax settings in order to make a fee_line non-taxable for "Tips/Fees".  However, this activity is not supported by the legacy API, so this will remain the case until the plugin is updated for the latest API, which will be either in v3 or v4 of the plugin.  Until then unfortunately the best solution would be to either manually edit each order in your WC backend or counteract your tax by deducting it from the tip input.

== Screenshots ==

1.  This is how the terminal appears in your checkout

== Changelog ==

= 2.2.4 - 2023-04-21 =
* PHP8.0 support for public magic methods

= 2.2.3 - 2022-09-13 =
* Support for WCPOS by Kilbot

= 2.2.2 - 2022-03-30 =
* Bug fixes

= 2.2.1 - 2022-03-09 =
* Improved tax logic and address data storage

= 2.2.0 - 2022-01-05 =
* Support for tips and taxes on mobile application as well as location management debugging, store ID and line item data for payment intents and more

= 2.1.4 - 2021-12-01 =
* Resolution of Stripe Gateway 5.8 regression error which hid the settings fields.  Inclusion of custom fee line items in API for mobile.

= 2.1.3 - 2021-11-08 =
* Import existing readers, resolve 404 stylesheet error, allow order-pay for FREE, subscription support language update, checkbox to support "processing" instead of "completed", support for coupon removal, improved support for external POS, and support for multiple subscription quantities.

= 2.1.2 - 2021-10-08 =
* Removal of root dependency, resolution of coupon code handling for API, removal of external products from API, Mobile App payment button condition change

= 2.1.1 - 2021-10-04 =
* Mobile App support for product images and subscriptions plus support for GBP and EUR, mobile checkout button with option and homepage redirect, removed US postcode requirement, copied session handler button to frontend, and support for Gateway 5.6

= 2.1.0 - 2021-08-26 =
* Support for new ArcanePOS mobile app features like search by name, sku, and category

= 2.0.4 - 20201-07-12 =
* Creates default location or pulls existing location for reader setup.

= 2.0.3 - 2021-06-22 =
* Permits cashiers to use BBPOS, extends autocancel timeout to 45 seconds, extends cookie storage to 2 weeks, and resolves "too many request" errors

= 2.0.1 - 2021-05-07 =
* Error handling

= 2.0.0 - 2021-04-12 =
* Support for WP, WC, Stripe Gateways 5.x+, BBPOS Chipper, custom fees, and order IDs.

= 1.2.0 - 2020-06-20 =
* Announcement for Stripe Connect

= 1.1.4 - 2020-09-29 =
* Support for BBPOS Chipper, ArcanePOS, Customer Payment Page

= 1.1.3 - 2020-08-03 =
* Support for Canadian currencies.

= 1.1.2 - 2020-05-19 =
* Critical Upgrade.  Prevents simultaneous load of FREE and LITE classes which have conflicting classes.  Without this, enabling both will cause 500 erros.

= 1.1.1 - 2020-04-20 =
* Adds fingerprint storage.  This is a hugely important update as it makes for easier customer-order synchronization on PRO services.

= 1.1.0 - 2020-03-24 =
* Includes promotions and discounts for active users

= 1.0.9 - 2020-02-19 =
* Allows payment intents for invalid reader displays

= 1.0.7 - 2020-02-06 =
* Added notification opt-in for plugin users to be notified of updates

= 1.0.6 - 2020-01-08 =
* Created stripe terminal child class to comply with Stripe's requirements for registered plugins

= 1.0.5 - 2019-12-20 =
* Fixes a retry setting conflict with PRO Services

= 1.0.4 - 2019-12-19 =
* Include missed error handling for the Stripe JS SDK
* Resolves conflicts with Pro Services.

= 1.0.3 - 2019-12-12 =
* Attempt to retry to process an order when an error occurs

= 1.0.2 - 2019-12-10 =
* Support for shipping products
* Delete readers action updated to remove on Stripe
* Support for php 7.0.  To get support for php5, please contact support@arcanestrategies.com
[See changelog for all versions](https://bitbucket.org/arcanestrategies/woocommerce_stripe_terminal/src/master/CHANGELOG.txt).

= 1.0.1 - 2019-11-14 =
* Changes to WP Listing and Settings UI
[See changelog for all versions](https://bitbucket.org/arcanestrategies/woocommerce_stripe_terminal/src/master/CHANGELOG.txt).

= 1.0.0 - 2019-10-15 =
* Initial release
[See changelog for all versions](https://bitbucket.org/arcanestrategies/woocommerce_stripe_terminal/src/master/CHANGELOG.txt).

== Upgrade Notice ==

= 2.2.4 =
2.2.4 PHP8.0 support for public magic methods

= 2.2.3 =
2.2.3 Implements support for WCPOS by Kilbot

= 2.2.2 =
2.2.2 Resolved a small bug from 2.2.1

= 2.2.1 =
2.2.1 Has improved tax logic and address data storage

= 2.2.0 =
2.2.0 Adds support for tips and taxes on mobile application and store ID and line item data for payment intents.  Version 2.2.0 of PRO includes additional customer data storage options, account creation options, and tax calculation improvements

= 2.0.3 =
2.0.3 Permits cashiers to use BBPOS, extends autocancel timeout to 45 seconds, extends cookie storage to 2 weeks, and resolves "too many request" errors

= 2.0.1 =
2.0.1 Resolves some syntax errors

= 2.0.0 =
2.0.0 Support for WP, WC, Stripe Gateways 5.x+, BBPOS Chipper, custom fees, and order IDs.

= 1.2.0 =
1.2.0 Announcement for Stripe Connect

= 1.1.4 =
1.1.4 Support for BBPOS Chipper, ArcanePOS, Customer Payment Page

= 1.1.3 =
1.1.3 Support for Canadian currencies.

= 1.1.2 =
1.1.2 Critical Upgrade.  Prevents simultaneous load of FREE and LITE classes which have conflicting classes.  Without this, enabling both will cause 500 erros.

= 1.1.1 =
1.1.1 Adds fingerprint storage.  This is a hugely important update as it makes for easier customer-order synchronization on PRO services

= 1.1.0 =
1.1.0 Includes promotions and discounts for active users

= 1.0.9 =
1.0.9 Allows payment intents for invalid reader displays

= 1.0.7 =
1.0.7 Added notification opt-in for plugin users to be notified of updates

= 1.0.6 =
1.0.6 complies with Stripe's partner requirements as a registered plugin.

= 1.0.5 =
1.0.5 fixes a retry setting conflict with PRO Services.

= 1.0.4 =
1.0.4 addresses missed error handling for the Stripe JS SDK and resolves conflicts with Pro Services.

= 1.0.3 =
1.0.3 adds the functionality to attempt to reprocess a payment if a functional error occurs.
[review update best practices](https://docs.woocommerce.com/document/how-to-update-your-site) before upgrading.

= 1.0.2 =
1.0.2 addresses a bug related to shipping costs in a cart and deleting readers on stripe. Also extends support down to php 7.0
[review update best practices](https://docs.woocommerce.com/document/how-to-update-your-site) before upgrading.

= 1.0.1 =
1.0.1 contains changes to the WP listing and Settings UI
[review update best practices](https://docs.woocommerce.com/document/how-to-update-your-site) before upgrading.

= 1.0 =
1.0 is the initial release
[review update best practices](https://docs.woocommerce.com/document/how-to-update-your-site) before upgrading.